<html>
<head>
<link rel="stylesheet" href="style.css">
<title>Back to the Future - Radio</title>
<style type="text/css">
/* https://codepen.io/KristopherVanSant/pen/dXdVJY */
@font-face {
  font-family: 'lcd';
  src: url('alarm-clock.ttf') format('truetype');
}
@font-face {
  font-family: 'dymo';
  src: url('microgramma.ttf') format('truetype');
e}
@font-face {
  font-family: 'dymo-bold';
  src: url('microgramma-bold.otf') format('opentype');
e}
body {
  filter: blur(0.5px);
  cursor: default;
  user-select: none;
}
#overlay {
  opacity: 0;
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0;
  left: 0;
  background: black;
  z-index: 1;
}
#overlay.white {
  background: white;
}
#tfc {
  cursor: pointer;
}
.container {
  width: 640px;
  font-family: 'lcd', sans-serif;
}
.label, .large-label {
  font-family: dymo;
  padding: 0 2px 0 2px;
  font-size: 14px;
  opacity: 0.75;
  letter-spacing: 1px;
}
.large-label {
  font-family: dymo-bold;
  width: 40%;
}
.box3 .large-label {
  width: 45%;
}
.display {
  /*text-shadow: 0 -2px 3px;*/
  text-shadow: 0 0 10px;
  padding-left: 4px;
  letter-spacing: 0;
  font-size: 48px;
}
.faded-eights {
  position: relative;
  top: -105px;
  left: 2px;
  opacity: 0.2;
  background: 0 none;
  border: 0 none;
}
.time {
  margin-top: 332%;
  margin-bottom: -263%;
}
.lit, .unlit {
  border-top: 1px solid white;
}
.lit {
  background: #f1ac17;
  box-shadow: 0px 0px 3px yellow;
}
.green .lit {
  background: #4cd338;
  box-shadow: 0px 0px 3px #4cd338;
}
</style>
<script type="text/javascript">
// Dynamic date/time.
var time = setInterval(function() {
  var now = new Date();
  const dateArray = [
    now.getFullYear(),    // Year
    now.toLocaleString('en-US', { month: 'short' }),
    //now.getMonth() + 1,   // Month (1–12)
    now.getDate(),        // Day of the month
    now.getHours(),       // Hour (0–23)
    now.getMinutes()      // Minute (0–59)
  ];

  var minute = document.querySelector('.now-min');
  minute.innerHTML = String(dateArray[4]).padStart(2, '0');
  var hour = document.querySelector('.now-hour');
  var hours = dateArray[3];
  const ampm = hours >= 12 ? 'PM' : 'AM';
  var am = document.querySelector('.now-am');
  var pm = document.querySelector('.now-pm');
  if (ampm == 'AM') {
    am.classList.add('lit');
    am.classList.remove('unlit');
    pm.classList.add('unlit');
    pm.classList.remove('lit');
  }
  else {
    pm.classList.add('lit');
    pm.classList.remove('unlit');
    am.classList.add('unlit');
    am.classList.remove('lit');
  }
  hours = hours % 12;
  hours = hours ? hours : 12; // Handle midnight (0 hours → 12)
  hour.innerHTML = String(hours).padStart(2, '0');
  var year = document.querySelector('.now-year');
  year.innerHTML = dateArray[0];
  var day = document.querySelector('.now-day');
  day.innerHTML = String(dateArray[2]).padStart(2, '0');
  var month = document.querySelector('.now-month');
  month.innerHTML = dateArray[1];

  // Blinking dots.
  var colon = document.querySelectorAll('.time');
  for (var dot of colon) {
    if (dot.classList.contains('lit')) {
      dot.classList.remove('lit');
      dot.classList.add('unlit');
    }
    else {
      dot.classList.remove('unlit');
      dot.classList.add('lit');
    }
  }
}, 500);

// Load.
window.addEventListener("load", function() {

  // time circuits on
  tfc.addEventListener("click", function() {
    // play sound
    player.src = 'assets/general/timeCircuits/tfcOn.wav';
    player.play();
    // enable all displays except month
    var x = document.querySelectorAll(".display");

    // fade in months top to bottom
  });

  // typing digits alters top row
  var counter = 0;
  var timer;
  var tmp;
  document.addEventListener("keypress", function(e) {
    e.preventDefault();

    var month = document.querySelector('.then-month');
    var day = document.querySelector('.then-day');
    var year = document.querySelector('.then-year');

    if (!isFinite(e.key)) {
      return;
    }

    // setTimeout wait for 8 keys
    clearTimeout(timer);
    timer = setTimeout(function() {
      counter = 0;
    }, 3000);

    // shift
    //var tmp = year.innerHTML;
    //var arr = [...tmp];
    if (counter == 0) {
      tmp = [
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
        '&nbsp;',
      ];
    }
    tmp[counter] = e.key;

    if (counter == 1) {
      var m = tmp.slice(0, 2).join('');
      var date = new Date('1985-' + m + '-01T00:00:00');
      if (date == "Invalid Date") {
        counter = 0;
        return;
      }
      var out = date.toLocaleString('en-US', { month: 'short' });
      month.innerHTML = out;
    }
    else if (counter == 3) {
console.log(tmp);
      var m = tmp.slice(0, 2).join('');
      var d = tmp.slice(2, 4).join('');
      var date = new Date('1985-' + m + '-' + d + 'T00:00:00');
console.log(date);
      if (date == "Invalid Date") {
        counter = 0;
        return;
      }
      day.innerHTML = d;
    }
    else if (counter == 7) {
      var m = tmp.slice(0, 2).join('');
      var d = tmp.slice(2, 4).join('');
      var y = tmp.slice(4, 8).join('');
      year.innerHTML = y;
    }

    // count keys
console.log({counter});
    counter++;
    if (counter > 7) {
      counter = 0;
    }
  });

  // ready radio
    // switch through static?
});
</script>
</head>
<body>
<div class="container">
  <div class="spacer"></div>
  <div class="box box1">
    <div class="wrapper">
      <p class="label">Month</p>
      <p class="display">Oct</p>
    </div>
    <div class="wrapper">
      <p class="label">Day</p>
      <p class="display">26</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Year</p>
      <p class="display">1985</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Am</p>
      <p class="lit"></p>
      <p class="label">Pm</p>
      <p class="unlit"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Hour</p>
      <p class="display">01</p>
    </div>
    <div class="wrapper padding">
      <p class="lit time"></p>
      <p class="lit time"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Min</p>
      <p class="display">21</p>
    </div>
    <p class="large-label">Destination Time</p>
  </div>
  <div class="box box2">
     <div class="wrapper">
      <p class="label">Month</p>
      <p class="display">Oct</p>
    </div>
    <div class="wrapper">
      <p class="label">Day</p>
      <p class="display">26</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Year</p>
      <p class="display">2015</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Am</p>
      <p class="lit"></p>
      <p class="label">Pm</p>
      <p class="unlit"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Hour</p>
      <p class="display">01</p>
    </div>
    <div class="wrapper padding">
      <p class="lit time"></p>
      <p class="lit time"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Min</p>
      <p class="display">22</p>
    </div>
    <p class="large-label">Present Time</p>
  </div>
  <div class="box box3">
     <div class="wrapper">
      <p class="label">Month</p>
      <p class="display">Oct</p>
    </div>
    <div class="wrapper">
      <p class="label">Day</p>
      <p class="display">26</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Year</p>
      <p class="display">1985</p>
    </div>
    <div class="wrapper padding">
      <p class="label">Am</p>
      <p class="lit"></p>
      <p class="label">Pm</p>
      <p class="unlit"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Hour</p>
      <p class="display">01</p>
    </div>
    <div class="wrapper padding">
      <p class="lit time"></p>
      <p class="lit time"></p>
    </div>
    <div class="wrapper padding">
      <p class="label">Min</p>
      <p class="display">20</p>
    </div>
    <p class="large-label">Last Time Departed</p>
  </div>
  <div class="wrapper4">
    <p></p>
    <p class="large-label">Time Circuits</p>
    <p class="large-label">Alarm Clock</p>
    <p></p>
  </div>
</div>
</body>
</html>
